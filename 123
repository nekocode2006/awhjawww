#             █ █ ▀ █▄▀ ▄▀█ █▀█ ▀
#             █▀█ █ █ █ █▀█ █▀▄ █
#              © Copyright 2022
#           https://t.me/hikariatama
#
# 🔒      Licensed under the GNU AGPLv3
# 🌐 https://www.gnu.org/licenses/agpl-3.0.html

# meta pic: https://static.hikari.gay/aniquotes_icon.png
# meta banner: https://mods.hikariatama.ru/badges/aniquotes.jpg
# meta developer: @Mmazzerratti
# scope: hikka_only
# scope: hikka_min 1.2.10

from hikkatl.types import Message
from .. import loader, utils
import traceback
from io import StringIO
import sys

@loader.tds
class Exec(loader.Module):
    strings = {"name": "Exec", "exec": "Exec"}
    strings_ru = {"exec": "Exec"}
    @loader.command(ru_doc="Выполнить команду")
    async def exec(self, message: Message):
        code = utils.get_args_raw(message)
        if code:
            try:
                output = sys.stdout = StringIO()
                exec(code)
                val = output.getvalue()
                if val.strip():
                    await utils.answer(message, output.getvalue())
            except:
                await utils.answer(message, traceback.format_exc())
